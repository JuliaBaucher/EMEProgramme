<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="color-scheme" content="light dark" />
  <title>EME ‚Äî Assistant IA (Extended Monaco Entreprises)</title>
  <meta name="description" content="Assistant officiel du programme Extended Monaco Entreprises (EME) ‚Äî Transformation num√©rique des entreprises mon√©gasques." />

  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;600;700&family=Source+Sans+Pro:wght@300;400;600;700&display=swap" rel="stylesheet" />

  <style>
    /* =========================
       EME / Monaco visual identity
       ========================= */
    :root{
      --monaco-red:#CE1126;
      --primary-blue:#003366;
      --secondary-blue:#0066CC;

      --bg0:#F8F9FA;
      --bg1:#E9ECEF;

      --panel:#ffffff;
      --panel-border:rgba(0,0,0,.10);

      --text:#212529;
      --text2:#495057;
      --muted:rgba(33,37,41,.68);

      --shadow:0 10px 30px rgba(0,0,0,.10);
      --shadow-sm:0 1px 2px rgba(0,0,0,.06);

      --radius:18px;

      --user:rgba(0,102,204,.14);
      --userText:#0f172a;

      --bot:rgba(0,0,0,.03);
      --botText:#212529;

      --error:rgba(220,53,69,.14);
      --errorText:#7f1d1d;

      --focus:rgba(0,102,204,.28);

      --header-height:84px;
      --max:1100px;
      --maxMsg:980px;

      --font-primary:'Source Sans Pro','Helvetica Neue',Helvetica,Arial,sans-serif;
      --font-secondary:'Roboto','Source Sans Pro',sans-serif;
      --font-mono:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,'Liberation Mono','Courier New',monospace;
    }

    :root[data-theme="dark"]{
      --bg0:#0b1220;
      --bg1:#111a2e;

      --panel:rgba(255,255,255,.05);
      --panel-border:rgba(255,255,255,.14);

      --text:rgba(255,255,255,.95);
      --text2:rgba(255,255,255,.78);
      --muted:rgba(255,255,255,.62);

      --shadow:0 12px 40px rgba(0,0,0,.35);
      --shadow-sm:0 2px 10px rgba(0,0,0,.22);

      --user:rgba(0,102,204,.22);
      --userText:rgba(255,255,255,.92);

      --bot:rgba(255,255,255,.07);
      --botText:rgba(255,255,255,.92);

      --error:rgba(239,68,68,.18);
      --errorText:#fecaca;

      --focus:rgba(0,102,204,.42);
    }

    @media (prefers-color-scheme:dark){
      :root:not([data-theme]){
        --bg0:#0b1220;
        --bg1:#111a2e;

        --panel:rgba(255,255,255,.05);
        --panel-border:rgba(255,255,255,.14);

        --text:rgba(255,255,255,.95);
        --text2:rgba(255,255,255,.78);
        --muted:rgba(255,255,255,.62);

        --shadow:0 12px 40px rgba(0,0,0,.35);
        --shadow-sm:0 2px 10px rgba(0,0,0,.22);

        --user:rgba(0,102,204,.22);
        --userText:rgba(255,255,255,.92);

        --bot:rgba(255,255,255,.07);
        --botText:rgba(255,255,255,.92);

        --error:rgba(239,68,68,.18);
        --errorText:#fecaca;

        --focus:rgba(0,102,204,.42);
      }
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family:var(--font-primary);
      color:var(--text);
      background:linear-gradient(180deg,var(--bg0),var(--bg1));
      line-height:1.5;
    }

    a{color:var(--secondary-blue);text-decoration:none}
    a:hover{text-decoration:underline}

    /* Accessibility */
    .skip-link{
      position:absolute; top:-44px; left:12px;
      background:var(--primary-blue);
      color:#fff;
      padding:10px 12px;
      border-radius:12px;
      z-index:9999;
    }
    .skip-link:focus{top:12px;outline:3px solid var(--focus);outline-offset:2px}

    /* Header (official style) */
    header.gov-header{
      background:var(--primary-blue);
      color:#fff;
      box-shadow:var(--shadow);
      position:sticky; top:0; z-index:30;
    }
    .gov-header__inner{
      max-width:var(--max);
      margin:0 auto;
      padding:16px 14px;
      min-height:var(--header-height);
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:14px;
      flex-wrap:wrap;
    }
    .brand{display:flex;align-items:center;gap:12px;min-width:0}
    .flag{
      width:34px;height:22px;border-radius:3px;overflow:hidden;
      box-shadow:0 0 0 1px rgba(255,255,255,0.25);
      flex:0 0 auto;
    }
    .flag__top{height:50%;background:#fff}
    .flag__bottom{height:50%;background:var(--monaco-red)}
    .brand__text{min-width:0;display:flex;flex-direction:column;gap:2px}
    .brand__title{
      margin:0;
      font-family:var(--font-secondary);
      font-weight:700;
      font-size:1.08rem;
      white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
    }
    .brand__subtitle{
      margin:0;
      font-size:0.92rem;
      color:rgba(255,255,255,0.86);
      white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
    }

    .header-actions{display:flex;align-items:center;gap:8px}
    .btn{
      appearance:none;
      border:1px solid rgba(255,255,255,0.26);
      background:transparent;
      color:#fff;
      border-radius:12px;
      padding:10px 12px;
      cursor:pointer;
      font:inherit;
      font-weight:600;
      display:inline-flex;
      align-items:center;
      gap:8px;
      transition:transform .15s ease, border-color .15s ease, background-color .15s ease, box-shadow .15s ease;
      user-select:none;
      white-space:nowrap;
    }
    .btn:hover{transform:translateY(-1px);border-color:rgba(255,255,255,0.46)}
    .btn:focus{outline:3px solid var(--focus);outline-offset:2px}
    .btn--primary{
      background:var(--secondary-blue);
      border-color:var(--secondary-blue);
    }
    .btn--primary:hover{
      background:#004c99;
      border-color:#004c99;
      box-shadow:var(--shadow-sm);
    }

    /* Page frame */
    .wrap{
      min-height:calc(100% - var(--header-height));
      display:flex;
      justify-content:center;
      padding:22px 14px 28px;
    }

    /* Two-column layout: left chat + right shortcuts */
    .layout{
      width:min(var(--max),100%);
      display:grid;
      grid-template-columns: 1fr 320px;
      gap:18px;
      align-items:start;
    }
    @media (max-width:1024px){
      .layout{grid-template-columns:1fr}
    }

    /* Card base */
    .card{
      background:var(--panel);
      border:1px solid var(--panel-border);
      border-radius:calc(var(--radius) + 6px);
      box-shadow:var(--shadow-sm);
      overflow:hidden;
    }

    /* Main app card keeps your original structure */
    .app{
      display:flex;
      flex-direction:column;
      min-height: calc(100vh - var(--header-height) - 22px - 28px);
      max-height: calc(100vh - var(--header-height) - 22px - 28px);
    }
    @media (max-width:1024px){
      .app{min-height:auto;max-height:none}
    }

    .app-header{
      padding:18px;
      border-bottom:1px solid var(--panel-border);
      display:flex;
      flex-direction:column;
      gap:10px;
    }
    .app-header h1{
      margin:0;
      font-family:var(--font-secondary);
      font-size:1.12rem;
      font-weight:800;
      color:var(--text);
      line-height:1.25;
    }
    .subtitle{font-size:0.95rem;color:var(--muted);max-width:70ch;margin:0}

    .disclaimer{
      font-size:0.92rem;
      color:var(--text2);
      background:rgba(0,0,0,.02);
      border:1px solid var(--panel-border);
      border-radius:14px;
      padding:12px 12px;
      line-height:1.55;
    }
    :root[data-theme="dark"] .disclaimer{background:rgba(255,255,255,.04)}
    @media (prefers-color-scheme:dark){ :root:not([data-theme]) .disclaimer{background:rgba(255,255,255,.04)} }

    .disclaimer strong{color:var(--text)}
    .disclaimer a{font-weight:700}

    .chat{
      flex:1;
      overflow:auto;
      padding:18px;
    }
    .messages{
      display:flex;
      flex-direction:column;
      gap:12px;
      max-width:var(--maxMsg);
      margin:0 auto;
    }

    .row{display:flex}
    .row.user{justify-content:flex-end}
    .row.bot,.row.system{justify-content:flex-start}

    .bubble{
      max-width:92%;
      padding:12px 14px;
      border-radius:16px;
      font-size:14px;
      white-space:pre-wrap;
      word-break:break-word;
      border:1px solid var(--panel-border);
      box-shadow:var(--shadow-sm);
      background:var(--bot);
      color:var(--botText);
    }
    .user .bubble{
      background:var(--user);
      color:var(--userText);
      border-bottom-right-radius:6px;
      border-color:rgba(0,102,204,.22);
    }
    .bot .bubble{
      border-bottom-left-radius:6px;
    }
    .system .bubble{
      background:rgba(206,17,38,.08);
      border-color:rgba(206,17,38,.25);
    }
    .bubble.error{background:var(--error);color:var(--errorText);border-color:rgba(220,53,69,.25)}

    footer.app-footer{
      border-top:1px solid var(--panel-border);
      padding:12px;
      background:rgba(0,0,0,.01);
    }
    :root[data-theme="dark"] footer.app-footer{background:rgba(255,255,255,.03)}
    @media (prefers-color-scheme:dark){ :root:not([data-theme]) footer.app-footer{background:rgba(255,255,255,.03)} }

    textarea{
      width:100%;
      resize:none;
      border-radius:14px;
      border:2px solid rgba(0,0,0,.12);
      padding:10px 12px;
      font-size:14px;
      outline:none;
      background:transparent;
      color:var(--text);
      font-family:var(--font-primary);
      transition:border-color .15s ease, box-shadow .15s ease;
    }
    :root[data-theme="dark"] textarea{border-color:rgba(255,255,255,.16)}
    @media (prefers-color-scheme:dark){ :root:not([data-theme]) textarea{border-color:rgba(255,255,255,.16)} }

    textarea:focus{
      border-color:rgba(0,102,204,.85);
      box-shadow:0 0 0 4px var(--focus);
    }

    .controls{
      display:flex;
      gap:10px;
      margin-top:8px;
      align-items:center;
      flex-wrap:wrap;
    }

    .send{
      border-radius:14px;
      border:2px solid var(--secondary-blue);
      padding:10px 14px;
      cursor:pointer;
      background:var(--secondary-blue);
      color:#fff;
      font-weight:800;
      font:inherit;
      transition:transform .15s ease, box-shadow .15s ease, background-color .15s ease, border-color .15s ease;
      user-select:none;
    }
    .send:hover{transform:translateY(-1px);box-shadow:var(--shadow-sm);background:#004c99;border-color:#004c99}
    .send:disabled{opacity:.6;cursor:not-allowed;transform:none;box-shadow:none}
    .send:focus{outline:3px solid var(--focus);outline-offset:2px}

    .ghost{
      border-radius:14px;
      border:2px solid var(--panel-border);
      padding:10px 14px;
      cursor:pointer;
      background:transparent;
      color:var(--text);
      font-weight:800;
      font:inherit;
      transition:transform .15s ease, box-shadow .15s ease, border-color .15s ease;
      user-select:none;
    }
    .ghost:hover{transform:translateY(-1px);box-shadow:var(--shadow-sm);border-color:rgba(0,0,0,.18)}
    :root[data-theme="dark"] .ghost:hover{border-color:rgba(255,255,255,.22)}
    @media (prefers-color-scheme:dark){ :root:not([data-theme]) .ghost:hover{border-color:rgba(255,255,255,.22)} }
    .ghost:focus{outline:3px solid var(--focus);outline-offset:2px}

    .hint{
      font-size:12px;
      color:var(--muted);
      margin-left:auto;
      font-variant-numeric:tabular-nums;
      padding:4px 10px;
      border:1px solid var(--panel-border);
      border-radius:999px;
      background:rgba(0,0,0,.02);
      white-space:nowrap;
    }
    :root[data-theme="dark"] .hint{background:rgba(255,255,255,.04)}
    @media (prefers-color-scheme:dark){ :root:not([data-theme]) .hint{background:rgba(255,255,255,.04)} }

    /* Sidebar shortcuts card */
    .side{
      padding:18px;
    }
    .side h2{
      margin:0 0 8px;
      font-family:var(--font-secondary);
      font-size:1.02rem;
      font-weight:900;
      color:var(--text);
    }
    .side p{
      margin:0 0 14px;
      color:var(--text2);
      font-size:0.95rem;
      line-height:1.55;
    }
    .quick-links{display:grid;gap:8px}
    .quick-links a{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      padding:12px 12px;
      border-radius:14px;
      border:1px solid var(--panel-border);
      background:rgba(0,0,0,.02);
      color:var(--text);
      font-weight:800;
      transition:transform .15s ease, box-shadow .15s ease, border-color .15s ease;
    }
    :root[data-theme="dark"] .quick-links a{background:rgba(255,255,255,.04)}
    @media (prefers-color-scheme:dark){ :root:not([data-theme]) .quick-links a{background:rgba(255,255,255,.04)} }
    .quick-links a:hover{transform:translateY(-1px);box-shadow:var(--shadow-sm);border-color:rgba(0,0,0,.18)}
    :root[data-theme="dark"] .quick-links a:hover{border-color:rgba(255,255,255,.22)}
    @media (prefers-color-scheme:dark){ :root:not([data-theme]) .quick-links a:hover{border-color:rgba(255,255,255,.22)} }
    .quick-links a:focus{outline:3px solid var(--focus);outline-offset:2px}

    /* Sticky sidebar (desktop) */
    .sidebar{
      position:sticky;
      top:calc(var(--header-height) + 18px);
      max-height:calc(100vh - var(--header-height) - 32px);
      overflow:auto;
    }
    @media (max-width:1024px){
      .sidebar{position:static;max-height:none;overflow:visible}
      .hint{margin-left:0}
    }
  </style>
</head>

<body>
  <a class="skip-link" href="#input">Aller au contenu</a>

  <header class="gov-header" role="banner">
    <div class="gov-header__inner">
      <div class="brand" aria-label="Extended Monaco Entreprises">
        <div class="flag" aria-hidden="true">
          <div class="flag__top"></div>
          <div class="flag__bottom"></div>
        </div>
        <div class="brand__text">
          <p class="brand__title">Extended Monaco Entreprises (EME)</p>
          <p class="brand__subtitle">Assistant officiel ‚Äî Transformation num√©rique des entreprises mon√©gasques</p>
        </div>
      </div>

      <div class="header-actions" role="group" aria-label="Actions">
        <button class="btn" id="themeToggle" type="button" aria-label="Basculer le mode clair/sombre">
          üåì <span>Th√®me</span>
        </button>
        <button class="btn" id="clearTop" type="button" aria-label="Effacer la conversation">
          üßπ <span>Effacer</span>
        </button>
        <a class="btn btn--primary" href="https://eme.gouv.mc/" target="_blank" rel="noopener" aria-label="Ouvrir le site officiel EME">
          üåê <span>Site EME</span>
        </a>
      </div>
    </div>
  </header>

  <div class="wrap">
    <main class="layout" role="main" aria-label="Assistant IA EME">
      <!-- Left: chat app -->
      <section class="card app" aria-label="Chat EME">
        <div class="app-header">
          <h1>Assistant IA ‚Äî Extended Monaco Entreprises</h1>
          <p class="subtitle">
            Assistant officiel du programme Extended Monaco Entreprises (EME) ‚Äî Transformation num√©rique des entreprises mon√©gasques.
          </p>

          <div class="disclaimer" id="disclaimer" role="note">
            <strong>Transparence IA :</strong> cet assistant fournit des informations g√©n√©rales sur le programme EME.
            Il ne remplace pas un conseil juridique/financier et ne garantit pas l‚Äô√©ligibilit√© au Fonds Bleu.
            √âvitez de partager des donn√©es sensibles. Besoin d‚Äôun humain ? Consultez la page
            <a href="https://eme.gouv.mc/contact" target="_blank" rel="noopener">Contact</a> ou la
            <a href="https://eme.gouv.mc/" target="_blank" rel="noopener">F.A.Q.</a>.
          </div>
        </div>

        <section class="chat" id="chat" aria-label="Historique de conversation" tabindex="0">
          <div class="messages" id="messages"></div>
        </section>

        <footer class="app-footer" aria-label="Zone de saisie">
          <textarea id="input" rows="2"
            placeholder="√âcrivez votre question‚Ä¶ (Entr√©e pour envoyer, Shift+Entr√©e pour une nouvelle ligne)"
            aria-label="Message"></textarea>

          <div class="controls">
            <button class="send" id="send" type="button" aria-label="Envoyer le message">Envoyer</button>
            <button class="ghost" id="clear" type="button" aria-label="Effacer la conversation">Effacer</button>
            <span class="hint" id="counter" aria-label="Compteur de caract√®res">0 / 4000</span>
          </div>
        </footer>
      </section>

      <!-- Right: shortcuts -->
      <aside class="card sidebar" aria-label="Raccourcis utiles">
        <div class="side">
          <h2>Raccourcis utiles</h2>
          <p>Acc√©dez rapidement aux ressources EME (site officiel).</p>

          <div class="quick-links" role="list">
            <a role="listitem" href="https://eme.gouv.mc/evaluer-sa-maturite-numerique/" target="_blank" rel="noopener">
              Autodiagnostic de maturit√© num√©rique <span aria-hidden="true">‚Üí</span>
            </a>
            <a role="listitem" href="https://eme.gouv.mc/rechercher-un-professionnel-du-numerique/" target="_blank" rel="noopener">
              Annuaire des professionnels du num√©rique <span aria-hidden="true">‚Üí</span>
            </a>
            <a role="listitem" href="https://eme.gouv.mc/programme-de-sensibilisation/" target="_blank" rel="noopener">
              Programme de sensibilisation (FlashUP) <span aria-hidden="true">‚Üí</span>
            </a>
            <a role="listitem" href="https://eme.gouv.mc/flashup-tool-box/" target="_blank" rel="noopener">
              FlashUP Tool Box <span aria-hidden="true">‚Üí</span>
            </a>
            <a role="listitem" href="https://eme.gouv.mc/financer-son-projet-3/" target="_blank" rel="noopener">
              Financer son projet (Fonds Bleu) <span aria-hidden="true">‚Üí</span>
            </a>
          </div>
        </div>
      </aside>
    </main>
  </div>

  <script>
  (() => {
    "use strict";

    /* =========================
       CONFIG
       ========================= */
    // ‚úÖ Your AWS API Gateway endpoint (must have CORS enabled for your GitHub Pages origin)
    // Example:
    // const API_URL = "https://by02teld6l.execute-api.eu-central-1.amazonaws.com/prod/chat";
    const API_URL = "https://by02teld6l.execute-api.eu-central-1.amazonaws.com/prod/chat";
    const MAX = 4000;

    const THEME_KEY = "eme_theme_v1";
    const STORAGE_KEY = "eme_chat_messages_v1";

    /* =========================
       ELEMENTS
       ========================= */
    const messagesEl = document.getElementById("messages");
    const inputEl = document.getElementById("input");
    const sendBtn = document.getElementById("send");
    const clearBtn = document.getElementById("clear");
    const clearTopBtn = document.getElementById("clearTop");
    const counterEl = document.getElementById("counter");
    const themeToggle = document.getElementById("themeToggle");

    /* =========================
       THEME
       ========================= */
    function setTheme(theme){
      if (!theme){
        document.documentElement.removeAttribute("data-theme");
        try{ localStorage.removeItem(THEME_KEY); }catch{}
        return;
      }
      document.documentElement.setAttribute("data-theme", theme);
      try{ localStorage.setItem(THEME_KEY, theme); }catch{}
    }

    function initTheme(){
      let saved = null;
      try{ saved = localStorage.getItem(THEME_KEY); }catch{}
      if (saved === "light" || saved === "dark") setTheme(saved);
    }

    function toggleTheme(){
      const current = document.documentElement.getAttribute("data-theme");
      if (current === "dark") setTheme("light");
      else if (current === "light") setTheme("dark");
      else setTheme("dark");
    }

    /* =========================
       CHAT STATE
       ========================= */
    function loadMessages(){
      try{
        const raw = localStorage.getItem(STORAGE_KEY);
        if(!raw) return [];
        const parsed = JSON.parse(raw);
        return Array.isArray(parsed) ? parsed : [];
      }catch{
        return [];
      }
    }

    function saveMessages(arr){
      try{ localStorage.setItem(STORAGE_KEY, JSON.stringify(arr)); }catch{}
    }

    let state = loadMessages();

    function add(role, text, isError=false){
      const row = document.createElement("div");
      row.className = "row " + role;

      const bubble = document.createElement("div");
      bubble.className = "bubble" + (isError ? " error" : "");
      bubble.textContent = text;

      row.appendChild(bubble);
      messagesEl.appendChild(row);
      messagesEl.scrollTop = messagesEl.scrollHeight;
    }

    function renderAll(){
      messagesEl.innerHTML = "";
      for(const m of state){
        add(m.role, m.text, !!m.isError);
      }
    }

    function setCounter(){
      const len = (inputEl.value || "").length;
      counterEl.textContent = `${len} / ${MAX}`;
    }

    function setSendEnabled(){
      const msg = (inputEl.value || "").trim();
      sendBtn.disabled = !(msg.length > 0 && msg.length <= MAX);
    }

    function pushState(role, text, isError=false){
      state.push({ role, text, isError });
      saveMessages(state);
    }

    /* =========================
       NETWORK
       ========================= */
    async function send(){
      const msg = (inputEl.value || "").trim();
      if(!msg || msg.length > MAX) return;

      // user bubble
      add("user", msg);
      pushState("user", msg);

      // reset input
      inputEl.value = "";
      setCounter();
      setSendEnabled();

      // typing bubble
      add("bot", "‚Ä¶");
      const typingNode = messagesEl.lastChild;

      try{
        const res = await fetch(API_URL, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ message: msg })
        });

        let data = null;
        try{ data = await res.json(); }catch{ data = null; }

        // remove typing
        if (typingNode && typingNode.parentNode) typingNode.parentNode.removeChild(typingNode);

        if(!res.ok){
          const detail = (data && (data.error || data.message)) ? String(data.error || data.message) : `Erreur serveur (${res.status})`;
          add("bot", `D√©sol√©, une erreur est survenue. ${detail}`, true);
          pushState("bot", `D√©sol√©, une erreur est survenue. ${detail}`, true);
          return;
        }

        const reply = (data && (data.reply || data.answer || data.message)) ? String(data.reply || data.answer || data.message) : "";
        if(!reply){
          add("bot", "R√©ponse vide ou format inattendu.", true);
          pushState("bot", "R√©ponse vide ou format inattendu.", true);
          return;
        }

        add("bot", reply);
        pushState("bot", reply);

      }catch(e){
        if (typingNode && typingNode.parentNode) typingNode.parentNode.removeChild(typingNode);
        add("bot","Erreur r√©seau / CORS. V√©rifiez que votre API Gateway autorise l‚Äôorigine GitHub Pages.", true);
        pushState("bot","Erreur r√©seau / CORS. V√©rifiez que votre API Gateway autorise l‚Äôorigine GitHub Pages.", true);
      }
    }

    function clearChat(){
      state = [];
      saveMessages(state);
      messagesEl.innerHTML = "";
    }

    /* =========================
       INIT
       ========================= */
    initTheme();
    renderAll();

    // initial welcome (only if empty)
    if(state.length === 0){
      const welcome = "Bonjour, je suis l‚ÄôAssistant IA du programme Extended Monaco Entreprises (EME). Comment puis-je vous aider (autodiagnostic, annuaire, Fonds Bleu, FlashUP‚Ä¶) ?";
      add("bot", welcome);
      pushState("bot", welcome);
    }

    themeToggle.addEventListener("click", toggleTheme);
    clearBtn.addEventListener("click", clearChat);
    clearTopBtn.addEventListener("click", clearChat);
    sendBtn.addEventListener("click", send);

    inputEl.addEventListener("keydown", (e) => {
      if(e.key === "Enter" && !e.shiftKey){
        e.preventDefault();
        if(!sendBtn.disabled) send();
      }
    });

    inputEl.addEventListener("input", () => {
      if(inputEl.value.length > MAX) inputEl.value = inputEl.value.slice(0, MAX);
      setCounter();
      setSendEnabled();
    });

    setCounter();
    setSendEnabled();
    inputEl.focus();
  })();
  </script>
</body>
</html>
